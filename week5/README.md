第五周作业
========

##### 作业
> 总结限流，熔断，降级的常用方式，重试的注意事项，负载均衡的常用方式。

- 限流常用方式
  - 单机限流
    - 令牌桶
    - 漏斗桶
  - 动态限流
    - BBR 限流
    - 广义各种连接池
  - 全局限流  
- 熔断常用方式
  - Gutter
  - 客户端流控
- 降级常用方式
  - 页面降级
  - 延迟服务
  - 读写降级
  - 缓存降级
  - 抛异常
  - 返回约定协议
  - Mock 数据
  - Fallback 处理
- 重试的注意事项
  - 限制重试次数和基于重试分布的策略（重试比率：10%）
  - 随机化、指数型递增的重试周期： `exponential ackoff + jitter`
  - `client`测记录重试次数直方图，传递到`server`，进行分布判定，交由`server`判定拒绝
  - 只应该在失败的这层进行重试，当重试仍然失败，全局约定错误码`过载，无须重试`，避免级联重试
- 负载均衡的常用方式
  - 随机算法
  - 加权轮询
  - 一致性 Hash
  - 最小活跃（JSQ）
  - p2c
    - 选择 `backend：CPU，client：health、inflight、latency`作为指标，使用一个简单的线性方程进行打分
    - 对新启动的节点使用常量惩罚值（penalty），以及使用探针方式最小化放量，进行预热
    - 打分比较低的节点，避免进入“永久黑名单”而无法恢复，使用统计衰减的方式，让节点指标逐渐恢复到初始状态(即默认值)。
    - 当前发出去的请求超过了 predict lagtency，就会加惩罚
